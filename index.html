<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	<title>Bad camera.</title>
	<meta name="author" content="Mike Almond">
	<meta name="copyright" content="Mike Almond, 2016">
	<meta name="description" content="A bad camera.">
	<meta name="keywords" content="glitch,jpeg,webcam,camera,html5,Haxe,OpenFL">
	<meta id="viewport" name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
	<meta name="apple-mobile-web-app-capable" content="yes">
	
	<script type="text/javascript" src="./lib/screenfull.min.js"></script>
	<script type="text/javascript" src="./lib/getUserMedia.min.js"></script>
	<script type="text/javascript" src="./imgfkr.min.js"></script>
	<script>
		window.addEventListener ("touchmove", function (event) { event.preventDefault (); }, false);
		if (typeof window.devicePixelRatio != 'undefined' && window.devicePixelRatio > 2) {
			var meta = document.getElementById ("viewport");
			meta.setAttribute ('content', 'width=device-width, initial-scale=' + (2 / window.devicePixelRatio) + ', user-scalable=no');
		}
	</script>	
	<script defer src="https://code.getmdl.io/1.1.3/material.min.js"></script>	
	<link href="https://code.getmdl.io/1.1.3/material.amber-blue.min.css" rel="stylesheet" >
	<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
	<link href="./styles.min.css" rel="stylesheet">
</head>
<body>
	<div id="startupLayout" class="layout mdl-layout mdl-layout--fixed-header mdl-js-layout">
		<main class="main mdl-layout__content">
			<div class="container mdl-grid">
				<div class="mdl-cell mdl-cell--3-col mdl-cell--hide-tablet mdl-cell--hide-phone"></div>
				
				<div class="content mdl-color--white mdl-shadow--4dp content mdl-color-text--grey-800 mdl-cell mdl-cell--6-col-desktop mdl-cell--9-col">
					<div class="title">
						<a id="start-camera-button">
							<span>
								<button id="" title="launch" class="mdl-button mdl-js-button mdl-button--fab mdl-button--mini-fab mdl-button--primary" style="margin-right:16px;margin-top:-13px;">
									<i class="material-icons ">videocam</i>
								</button>
								<h3 style="display:inline-block;">bad camera</h3>
							</span>
						</a>
					</div>
					<hr/>
					<p>
						I'm making a tool that uses a modified JPEG encoder to generate lo-fi, glitchy, images.
						However, after getting the basics working, I couldn't resist trying it out on some video.
					</p>
					<p>
						This experiment uses the <a href="https://developer.mozilla.org/en-US/docs/Web/API/MediaDevices/getUserMedia">getUserMedia</a> API to access your camera, 
						copies the video stream to a canvas element, and encodes frames using the JPEG encoder.
						It's a fairly processor intensive operation, so is definitely not mobile friendly, but should give reasonable framerates on desktop.
					</p>
					<p>
						<a href="https://twitter.com/mikedotalmond/">@mikedotalmond</a>
					</p>
				</div>
			</div>
		</main>
    </div>	
	<div id="errorLayout" class="layout mdl-layout mdl-layout--fixed-header mdl-js-layout">
		<main class="main mdl-layout__content">
			<div class="container mdl-grid">
				<div class="mdl-cell mdl-cell--3-col mdl-cell--hide-tablet mdl-cell--hide-phone"></div>
				<div class="content mdl-color--white mdl-shadow--4dp content mdl-color-text--grey-800 mdl-cell mdl-cell--6-col-desktop mdl-cell--9-col">
					<div class="error-title">
						<i class="material-icons md-36 warning-icon">warning</i>
						<h3>uh-oh</h3>
					</div>
					<p>I can't access the camera. Sad times.</p>
					<hr/>
					<code class="warning">Error: <span id="errorMessage"></span></code>
				</div>
			</div>
		</main>
    </div>		
	<div id="controls">
		<button id="fullscreen-button" title="fullscreen" class="mdl-button mdl-js-button mdl-button--fab mdl-button--mini-fab mdl-button--primary">
			<i class="material-icons ">fullscreen</i>
		</button>
		<button id="stop-camera-button" title="close camera" class="mdl-button mdl-js-button mdl-button--fab mdl-button--mini-fab mdl-button--primary">
			<i class="material-icons ">videocam_off</i>
		</button>
	</div>	
	<div id="camera-container">
		<canvas id="camera-canvas" ></canvas>
		<video autoplay id="camera-video"></video>
	</div>	
	<div id="openfl-content"></div>
	<script type="text/javascript">lime.embed ("openfl-content", 0, 0, "1A1A1A");</script>
	<script>
	  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	  ga('create', 'UA-76676809-1', 'auto');
	  ga('send', 'pageview');
	</script>
</body>
</html>